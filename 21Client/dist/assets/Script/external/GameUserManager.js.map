{"version":3,"sources":["../../../../assets/Script/external/GameUserManager.js"],"names":["ClientUserItem","require","GD","GameUserManager","cc","Class","properties","tableUserItem","clientKernel","ctor","console","error","init","deleteUserItem","clientUserItem","getChairID","length","chairID","onUserItemDelete","createNewUserItem","userInfo","userItem","userID","tableID","onUserItemActive","updateUserItemScore","userScore","score","onUserItemUpdateScore","updateUserItemStatus","statusInfo","userStatus","onUserItemUpdateStatus","getUserByUserID","i","getUserID","getTableUserItem","getUserByGameID","gameID","getGameID"],"mappings":";;AAAA,IAAIA,iBAAiBC,QAAQ,gBAAR,CAArB;AACA,IAAIC,KAAKD,QAAQ,IAAR,CAAT;;AAEA,IAAIE,kBAAkBC,GAAGC,KAAH,CAAS;;AAE3BC,gBAAY;AACRC,uBAAe,IADP;AAERC,sBAAc;;AAFN,KAFe;;AAQ3BC,UAAM,gBAAW;;AAEbC,gBAAQC,KAAR,CAAc,wBAAd;AAIH,KAd0B;AAe3BC,UAAM,cAASJ,YAAT,EAAuB;AACzB,aAAKD,aAAL,GAAqB,EAArB;AACA,aAAKC,YAAL,GAAoBA,YAApB;AACH,KAlB0B;;AAqB3B;AACAK,oBAAgB,wBAASC,cAAT,EAAyB;AACrC,YAAIA,kBAAkB,IAAlB,IAA0BA,eAAeC,UAAf,MAA+B,KAAKR,aAAL,CAAmBS,MAAhF,EAAwF;AACpF,mBAAO,KAAP;AACH;;AAGD,YAAIC,UAAUH,eAAeC,UAAf,EAAd;AACA,YAAI,KAAKR,aAAL,CAAmBU,OAAnB,KAA+BH,cAAnC,EAAmD;AAC/C,mBAAO,KAAP;AACH;AACD,aAAKP,aAAL,CAAmBU,OAAnB,IAA8B,IAA9B;AACA,aAAKT,YAAL,CAAkBU,gBAAlB,CAAmCJ,cAAnC;;AAGA,eAAO,IAAP;AACH,KArC0B;AAsC3B;AACAK,uBAAmB,2BAASC,QAAT,EAAmB;;AAGlC,YAAIC,WAAW,IAAIrB,cAAJ,EAAf;AACAqB,iBAAST,IAAT,CAAcQ,QAAd;;AAEA,YAAIC,SAASC,MAAT,IAAmBpB,GAAGoB,MAA1B,EAAkC;AAC9BpB,eAAGe,OAAH,GAAaI,SAASJ,OAAtB;AACAf,eAAGqB,OAAH,GAAaF,SAASE,OAAtB;AACH;;AAED,aAAKhB,aAAL,CAAmBa,SAASH,OAA5B,IAAuCI,QAAvC;AACA,aAAKb,YAAL,CAAkBgB,gBAAlB,CAAmCH,QAAnC;AACA,eAAOA,QAAP;AACH,KArD0B;AAsD3B;;;;AAIA;AACAI,yBAAqB,6BAASX,cAAT,EAAyBY,SAAzB,EAAoC;AACrDZ,uBAAea,KAAf,GAAuBD,SAAvB;AACA,aAAKlB,YAAL,CAAkBoB,qBAAlB,CAAwCd,cAAxC,EAAwDY,SAAxD;AACH,KA9D0B;AA+D3B;AACAG,0BAAsB,8BAASf,cAAT,EAAyBgB,UAAzB,EAAqC;AACvDhB,uBAAeS,OAAf,GAAyBO,WAAWP,OAApC;AACAT,uBAAeG,OAAf,GAAyBa,WAAWb,OAApC;AACAH,uBAAeiB,UAAf,GAA4BD,WAAWC,UAAvC;AACA,aAAKvB,YAAL,CAAkBwB,sBAAlB,CAAyClB,cAAzC,EAAyDgB,UAAzD;AACH,KArE0B;;AAuE3B;;;;AAIA;AACAG,qBAAiB,yBAASX,MAAT,EAAiB;AAC9B;AACA,aAAK,IAAIY,IAAI,CAAb,EAAgBA,IAAI,KAAK3B,aAAL,CAAmBS,MAAvC,EAA+C,EAAEkB,CAAjD,EAAoD;AAChD,gBAAIb,WAAW,KAAKd,aAAL,CAAmB2B,CAAnB,CAAf;AACA,gBAAKb,YAAY,IAAb,IAAuBA,SAASc,SAAT,MAAwBb,MAAnD,EAA4D;AACxD,uBAAOD,QAAP;AACH;AACJ;;AAED,eAAO,IAAP;AACH,KAtF0B;AAuF3B;AACAe,sBAAkB,0BAASnB,OAAT,EAAkB;AAChC,eAAO,KAAKV,aAAL,CAAmBU,OAAnB,CAAP;AACH,KA1F0B;AA2F3B;AACAoB,qBAAiB,yBAASC,MAAT,EAAiB;AAC9B;AACA,aAAK,IAAIJ,IAAI,CAAb,EAAgBA,IAAI,KAAK3B,aAAL,CAAmBS,MAAvC,EAA+C,EAAEkB,CAAjD,EAAoD;AAChD,gBAAIb,WAAW,KAAKd,aAAL,CAAmB2B,CAAnB,CAAf;AACA,gBAAKb,YAAY,IAAb,IAAuBA,SAASkB,SAAT,MAAwBD,MAAnD,EAA4D;AACxD,uBAAOjB,QAAP;AACH;AACJ;;AAED,eAAO,IAAP;AACH;AAtG0B,CAAT,CAAtB","file":"GameUserManager.js","sourcesContent":["var ClientUserItem = require(\"ClientUserItem\")\r\nvar GD = require(\"GD\")\r\n\r\nvar GameUserManager = cc.Class({\r\n\r\n    properties: {\r\n        tableUserItem: null,\r\n        clientKernel: null,\r\n\r\n    },\r\n\r\n    ctor: function() {\r\n\r\n        console.error(\"GameUserManager ctor 1\")\r\n\r\n\r\n\r\n    },\r\n    init: function(clientKernel) {\r\n        this.tableUserItem = [];\r\n        this.clientKernel = clientKernel;\r\n    },\r\n\r\n\r\n    //删除用户\r\n    deleteUserItem: function(clientUserItem) {\r\n        if (clientUserItem == null || clientUserItem.getChairID() >= this.tableUserItem.length) {\r\n            return false;\r\n        }\r\n\r\n\r\n        var chairID = clientUserItem.getChairID();\r\n        if (this.tableUserItem[chairID] != clientUserItem) {\r\n            return false;\r\n        }\r\n        this.tableUserItem[chairID] = null;\r\n        this.clientKernel.onUserItemDelete(clientUserItem);\r\n\r\n\r\n        return true;\r\n    },\r\n    //创建玩家\r\n    createNewUserItem: function(userInfo) {\r\n\r\n\r\n        var userItem = new ClientUserItem();\r\n        userItem.init(userInfo)\r\n\r\n        if (userItem.userID == GD.userID) {\r\n            GD.chairID = userItem.chairID\r\n            GD.tableID = userItem.tableID\r\n        }\r\n\r\n        this.tableUserItem[userInfo.chairID] = userItem;\r\n        this.clientKernel.onUserItemActive(userItem);\r\n        return userItem;\r\n    },\r\n    /*\r\n     *信息更新\r\n     */\r\n\r\n    //更新分数\r\n    updateUserItemScore: function(clientUserItem, userScore) {\r\n        clientUserItem.score = userScore;\r\n        this.clientKernel.onUserItemUpdateScore(clientUserItem, userScore);\r\n    },\r\n    //更新状态\r\n    updateUserItemStatus: function(clientUserItem, statusInfo) {\r\n        clientUserItem.tableID = statusInfo.tableID;\r\n        clientUserItem.chairID = statusInfo.chairID;\r\n        clientUserItem.userStatus = statusInfo.userStatus;\r\n        this.clientKernel.onUserItemUpdateStatus(clientUserItem, statusInfo);\r\n    },\r\n\r\n    /*\r\n     *查找操作\r\n     */\r\n\r\n    //通过游戏ID查找用户\r\n    getUserByUserID: function(userID) {\r\n        //桌子用户\r\n        for (var i = 0; i < this.tableUserItem.length; ++i) {\r\n            var userItem = this.tableUserItem[i];\r\n            if ((userItem != null) && (userItem.getUserID() == userID)) {\r\n                return userItem;\r\n            }\r\n        }\r\n\r\n        return null;\r\n    },\r\n    //桌子玩家\r\n    getTableUserItem: function(chairID) {\r\n        return this.tableUserItem[chairID];\r\n    },\r\n    //通过昵称查找玩家\r\n    getUserByGameID: function(gameID) {\r\n        //玩家用户\r\n        for (var i = 0; i < this.tableUserItem.length; ++i) {\r\n            var userItem = this.tableUserItem[i];\r\n            if ((userItem != null) && (userItem.getGameID() == gameID)) {\r\n                return userItem;\r\n            }\r\n        }\r\n\r\n        return null;\r\n    }\r\n});"]}