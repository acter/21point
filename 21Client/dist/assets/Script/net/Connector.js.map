{"version":3,"sources":["../../../../assets/Script/net/Connector.js"],"names":["SocketIO","window","io","Connector","sock","isConnecting","isConnect","activeDisConnect","uri","serverURI","cc","log","connect","reconnection","on","onConnect","bind","onDisconnct","onError","onMsg","data","onfire","fire","eventName","close","route","console","error","emit","module","exports"],"mappings":";;;;;;AAAA,IAAIA,WAAWA,YAAYC,OAAOC,EAAlC;;IAGMC,S;AACF,yBAAc;AAAA;;AACV,aAAKC,IAAL,GAAY,IAAZ;AACA,aAAKC,YAAL,GAAoB,KAApB;AACA,aAAKC,SAAL,GAAiB,KAAjB;AACA,aAAKC,gBAAL,GAAwB,KAAxB;AACH;;;;gCACOC,G,EAAK;AACT,iBAAKC,SAAL,GAAiBD,GAAjB;AACA,iBAAKJ,IAAL,GAAY,IAAZ;AACA,iBAAKC,YAAL,GAAoB,IAApB;;AAEAK,eAAGC,GAAH,CAAO,UAAP,EAAmBH,GAAnB;AACA,iBAAKJ,IAAL,GAAYJ,SAASY,OAAT,CAAiBJ,GAAjB,EAAsB;AAC9BK,8BAAc;AADgB,aAAtB,CAAZ;AAGA;AACA,iBAAKT,IAAL,CAAUU,EAAV,CAAa,SAAb,EAAwB,KAAKC,SAAL,CAAeC,IAAf,CAAoB,IAApB,CAAxB;AACA,iBAAKZ,IAAL,CAAUU,EAAV,CAAa,YAAb,EAA2B,KAAKG,WAAL,CAAiBD,IAAjB,CAAsB,IAAtB,CAA3B;AACA,iBAAKZ,IAAL,CAAUU,EAAV,CAAa,OAAb,EAAsB,KAAKI,OAAL,CAAaF,IAAb,CAAkB,IAAlB,CAAtB;AACA,iBAAKZ,IAAL,CAAUU,EAAV,CAAa,KAAb,EAAoB,KAAKK,KAAL,CAAWH,IAAX,CAAgB,IAAhB,CAApB;AACH;;;kCAESI,I,EAAM;AACZV,eAAGC,GAAH,CAAO,WAAW,KAAKF,SAAvB;AACA,iBAAKH,SAAL,GAAiB,IAAjB;AACA,iBAAKD,YAAL,GAAoB,KAApB;AACAgB,mBAAOC,IAAP,CAAY,WAAZ,EAAyBF,IAAzB;AACH;;;oCACWA,I,EAAM;AACdV,eAAGC,GAAH,CAAO,UAAP;AACA,iBAAKL,SAAL,GAAiB,KAAjB;AACA,iBAAKD,YAAL,GAAoB,KAApB;AACA,iBAAKD,IAAL,GAAY,IAAZ;AACAiB,mBAAOC,IAAP,CAAY,aAAZ,EAA2BF,IAA3B;AACH;;;gCAEOA,I,EAAM;AACVV,eAAGC,GAAH,CAAO,aAAP;AACA,iBAAKN,YAAL,GAAoB,KAApB;AACA,iBAAKC,SAAL,GAAiB,KAAjB;AACA,iBAAKF,IAAL,GAAY,IAAZ;AACAiB,mBAAOC,IAAP,CAAY,SAAZ,EAAuBF,IAAvB;AACH;;;8BAEKG,S,EAAWH,I,EAAM;AACnBV,eAAGC,GAAH,CAAO,WAAP,EAAoBY,SAApB,EAA+BH,IAA/B;AACAC,mBAAOC,IAAP,CAAYC,SAAZ,EAAuBH,IAAvB;AACH;;;qCAEY;AACT,iBAAKhB,IAAL,IAAa,KAAKA,IAAL,CAAUoB,KAAV,EAAb;AACH;;AAED;;;;;;;6BAIKC,K,EAAOF,S,EAAWH,I,EAAM;AACzBK,oBAAQA,SAAS,OAAjB;AACAF,wBAAYA,aAAa,SAAzB;AACA,gBAAI,KAAKnB,IAAL,IAAa,IAAjB,EACI;;AAEJsB,oBAAQC,KAAR,CAAcJ,SAAd,EAAyBH,IAAzB;AACA,iBAAKhB,IAAL,CAAUwB,IAAV,CAAeH,KAAf,EAAsBF,SAAtB,EAAiCH,IAAjC;AACH;;;;;;AAILS,OAAOC,OAAP,GAAiB3B,SAAjB","file":"Connector.js","sourcesContent":["var SocketIO = SocketIO || window.io;\r\n\r\n\r\nclass Connector {\r\n    constructor() {\r\n        this.sock = null\r\n        this.isConnecting = false;\r\n        this.isConnect = false\r\n        this.activeDisConnect = false;\r\n    }\r\n    connect(uri) {\r\n        this.serverURI = uri;\r\n        this.sock = null;\r\n        this.isConnecting = true;\r\n\r\n        cc.log(\"正在连接中...\", uri);\r\n        this.sock = SocketIO.connect(uri, {\r\n            reconnection: false\r\n        });\r\n        //链接事件\r\n        this.sock.on(\"connect\", this.onConnect.bind(this));\r\n        this.sock.on(\"disconnect\", this.onDisconnct.bind(this));\r\n        this.sock.on(\"error\", this.onError.bind(this));\r\n        this.sock.on(\"msg\", this.onMsg.bind(this));\r\n    }\r\n\r\n    onConnect(data) {\r\n        cc.log(\"连接成功: \" + this.serverURI);\r\n        this.isConnect = true;\r\n        this.isConnecting = false;\r\n        onfire.fire(\"onConnect\", data)\r\n    }\r\n    onDisconnct(data) {\r\n        cc.log(\"断开连接----\");\r\n        this.isConnect = false;\r\n        this.isConnecting = false;\r\n        this.sock = null;\r\n        onfire.fire(\"onDisconnct\", data)\r\n    }\r\n\r\n    onError(data) {\r\n        cc.log(\"onError----\");\r\n        this.isConnecting = false;\r\n        this.isConnect = false;\r\n        this.sock = null;\r\n        onfire.fire(\"onError\", data)\r\n    }\r\n\r\n    onMsg(eventName, data) {\r\n        cc.log(\"onMsg----\", eventName, data);\r\n        onfire.fire(eventName, data)\r\n    }\r\n\r\n    disconnect() {\r\n        this.sock && this.sock.close()\r\n    }\r\n\r\n    /**\r\n     * 发送数据包\r\n     * @param data\r\n     */\r\n    emit(route, eventName, data) {\r\n        route = route || \"plaza\"\r\n        eventName = eventName || \"message\";\r\n        if (this.sock == null)\r\n            return;\r\n\r\n        console.error(eventName, data)\r\n        this.sock.emit(route, eventName, data);\r\n    }\r\n\r\n}\r\n\r\nmodule.exports = Connector"]}