{"version":3,"sources":["../../../../assets/Script/utils/Util.js"],"names":["Util","unique","_Util","U","numberMaker","img","num","w","h","removeSignal","numSprs","layout","ccui","Layout","anchor","maker","mod","numSpr","cc","Sprite","to","Math","floor","setTextureRect","rect","push","setContentSize","size","length","numCount","i","spr","p","numberTran","s","base","toFixed","numberMakerWithConfig","config","isEnglish","isInt","isShort","numberTextMaker","numWidth","numText","len","data","width","x","height","playAnimation","armatureName","animationName","durationTo","loop","delayTime","armature","ccs","Armature","getAnimation","play","setTimeout","removeFromParent","labelMaker","text","fontName","GFontDef","fontSize","fontColor","color","point","lab","LabelTTF","setAnchorPoint","setFontFillColor","buttonMaker","normalImg","selectedImg","disabledImg","handler","btn","FocusButton","Widget","PLIST_TEXTURE","addClickEventListener","animMaker","imgPre","interval","fillZero","animFrames","str","spriteFrameCache","getSpriteFrame","animation","Animation","create","Animate","randNum","min","max","offset","random","copyArray","sourceArr","targetArr","iteration","copyArr","Array","rowArr","copy","countCard","cards","hard","canBlackJack","CARD_ACE","RANK_21","RANK_16","sum","isAce","isAceExist","cardNum","cardRank","isBust","isBlackJack","isFiveDragon","module","exports"],"mappings":"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","file":"Util.js","sourcesContent":["/**\r\n * 辅助工具\r\n *\r\n * Created by BiteLu on 16/7/29.\r\n */\r\nvar Util = (function(){\r\n    var unique;\r\n    unique = new _Util();\r\n    return unique;\r\n})();\r\n\r\n//私有构造方法\r\nfunction _Util () {\r\n\r\n}\r\n\r\nvar U = Util;\r\n\r\n/**\r\n * 图片数字\r\n * @param img   图片资源\r\n * @param num   数字\r\n * @param w\r\n * @param h\r\n * @param removeSignal\r\n * @returns {string}\r\n */\r\nU.numberMaker = function(img, num, w, h, removeSignal){\r\n    var numSprs = [];\r\n    var layout = new ccui.Layout().anchor(0.6, 0.5);\r\n\r\n    var maker = function(num){\r\n        var mod = num % 10;\r\n        var numSpr = new cc.Sprite(img).to(layout);\r\n\r\n        num = Math.floor(num * 0.1);\r\n        numSpr.setTextureRect(cc.rect(mod * w, 0, w, h));\r\n        numSprs.push(numSpr);\r\n\r\n        if(num > 0) return maker(num);\r\n    };\r\n\r\n    // 递归构造所有数字\r\n    maker(num);\r\n    // 插入符号\r\n    if(!removeSignal){\r\n        var numSpr = new cc.Sprite(img).to(layout);\r\n\r\n        numSpr.setTextureRect(cc.rect(10 * w, 0, w, h));\r\n        numSprs.push(numSpr);\r\n    }\r\n    // 调整节点大小\r\n    layout.setContentSize(cc.size(w * numSprs.length, 0));\r\n\r\n    layout.numCount = numSprs.length;\r\n    // 排列数字\r\n    for(var i = 0; i < layout.numCount; i++){\r\n        var spr = numSprs[i];\r\n        spr.p(w * (layout.numCount - i), 0);\r\n    }\r\n\r\n    return layout;\r\n};\r\n/**\r\n *配置数字\r\n */\r\nU.numberTran = function(num){\r\n    var s = \"\";\r\n    var base = 1;\r\n    if (num >= 100000000) {\r\n        s = \"Y\";\r\n        base = 100000000;\r\n    } else if (num >= 10000) {\r\n        s = \"W\";\r\n        base = 10000;\r\n    }\r\n    num = (num / base).toFixed(0);\r\n    return num + s;\r\n}\r\n/**\r\n * 根据配置构造数字\r\n * @param img\r\n * @param num\r\n * @param config\r\n * @param isEnglish\r\n * @param isInt\r\n * @returns {*}\r\n */\r\nU.numberMakerWithConfig = function(img, num, config, isEnglish, isInt, isShort){\r\n    var layout = new ccui.Layout().anchor(cc.p(0.5, 0.5));\r\n\r\n    var numberTextMaker = function(num, isEnglish, isInt){\r\n        var s = \"\";\r\n        var base = 1;\r\n\r\n        if (isEnglish) {\r\n            if (num >= 1000000) {\r\n                s = \"M\";\r\n                base = 1000000;\r\n            } else if (num >= 1000) {\r\n                s = \"K\";\r\n                base = 1000;\r\n            }\r\n        } else {\r\n            if (num >= 100000000) {\r\n                s = \"亿\";\r\n                base = 100000000;\r\n            } else if (num >= 10000) {\r\n                s = \"万\";\r\n                base = 10000;\r\n            }\r\n        }\r\n\r\n        num = (num / base).toFixed(isInt ? 0 : 2);\r\n        return num + s;\r\n    };\r\n\r\n    var numWidth = 0;\r\n    var numText = isShort ? numberTextMaker(num, isEnglish, isInt) : \"\" + num;\r\n\r\n    for (var i = 0, len = numText.length; i < len; i++) {\r\n        var data = config[numText[i]];\r\n        var numSpr = new cc.Sprite(img).to(layout).p(numWidth, 0);\r\n\r\n        numWidth += data.width;\r\n        numSpr.setTextureRect(cc.rect(data.x, 0, data.width, data.height));\r\n    }\r\n\r\n    layout.setContentSize(cc.size(numWidth, 0));\r\n\r\n    return layout;\r\n};\r\n\r\nU.playAnimation = function(armatureName, animationName, durationTo, loop, delayTime){\r\n    var armature = new ccs.Armature(armatureName);\r\n    if (animationName && animationName != \"\") {\r\n        armature.getAnimation().play(animationName, durationTo, loop);\r\n    }\r\n\r\n    if (delayTime && delayTime > 0) {\r\n        (function(){\r\n            setTimeout(function(){\r\n                armature.removeFromParent();\r\n            }, delayTime * 1000);\r\n        })(armature);\r\n    }\r\n\r\n    return armature;\r\n};\r\n\r\n/**\r\n * 标签构造器\r\n * @param config\r\n */\r\nU.labelMaker =  function(config){\r\n    var text = config.text || \"\";\r\n    var fontName = config.fontName || GFontDef.fontName;\r\n    var fontSize = config.fontSize || GFontDef.fontSize;\r\n    var fontColor = config.fontColor || cc.color(255, 255, 255);\r\n    var point = config.point || cc.p(0, 0);\r\n    var anchor = config.anchor || cc.p(0.5, 0.5);\r\n\r\n    var lab = new cc.LabelTTF(text, fontName, fontSize).p(point);\r\n    lab.setAnchorPoint(anchor);\r\n    lab.setFontFillColor(fontColor);\r\n\r\n    return lab;\r\n};\r\n\r\nU.buttonMaker = function(normalImg, selectedImg, disabledImg, handler){\r\n    var btn = new FocusButton(normalImg, selectedImg, disabledImg, ccui.Widget.PLIST_TEXTURE);\r\n\r\n    btn.addClickEventListener(handler);\r\n    return btn;\r\n};\r\n\r\n/**\r\n * 动画构造器\r\n * @param imgPre    图片资源前缀\r\n * @param num       动画帧数\r\n * @param interval  动画播放间隔\r\n * @returns {*}\r\n */\r\nU.animMaker = function(imgPre, num, interval, fillZero){\r\n    var animFrames = [];\r\n\r\n    // 采用循环获得plist里面的内容并存入数组\r\n    for(var i = 1; i < num; i++){\r\n        var str = imgPre + (fillZero && i < 10 ? \"0\" : \"\") + i +\".png\";\r\n        animFrames.push(cc.spriteFrameCache.getSpriteFrame(str));\r\n    }\r\n\r\n    var animation = cc.Animation.create(animFrames, interval);\r\n\r\n    return new cc.Animate(animation);\r\n};\r\n\r\n/**\r\n * 产生指定范围的随机数[min, max)\r\n * @param min           最小值\r\n * @param max           最大值\r\n * @param isInt         是否取整\r\n * @returns {number}    返回随机数\r\n */\r\nU.randNum = function(min, max, isInt){\r\n    min = min || 0;\r\n    max = max || 0;\r\n    var offset = max - min;\r\n    var num = min + Math.random() * offset;\r\n\r\n    return isInt ? Math.floor(num) : num;\r\n};\r\n\r\n/**\r\n * 拷贝数组\r\n * @param sourceArr     要拷贝的对象\r\n * @param targetArr     拷贝后的对象\r\n */\r\nU.copyArray = function(sourceArr, targetArr){\r\n    targetArr = targetArr || [];\r\n    var iteration = function(sourceArr, copyArr){\r\n        copyArr = copyArr || [];\r\n        if (sourceArr instanceof Array) {\r\n            for (var i = 0, len = sourceArr.length; i < len; i++) {\r\n                var rowArr = sourceArr[i];\r\n                if (rowArr instanceof Array) {\r\n                    var copy = iteration(rowArr, []);\r\n                    copyArr.push(copy);\r\n                } else {\r\n                    copyArr.push(rowArr);\r\n                }\r\n            }\r\n        }\r\n\r\n        return copyArr;\r\n    };\r\n\r\n    // 开始拷贝迭代\r\n    return iteration(sourceArr, targetArr);\r\n};\r\n\r\n// 算牌。hard即硬牌,A只算1点。开始算牌时A先当做软牌(11点)算,爆牌了再按硬牌(1点)算\r\nU.countCard = function(cards, hard, canBlackJack){\r\n    var CARD_ACE = 1;           // 卡牌A\r\n    var RANK_21 = 21;           // 21点\r\n    var RANK_16 = 16;           // 16点\r\n\r\n    var sum = 0;\r\n    var isAce = false;      // 是否是A\r\n    var isAceExist = false; // 是否有A存在\r\n    var cardNum = cards.length;\r\n\r\n    // 计算牌的点数\r\n    for (var i = 0; i < cardNum; i++) {\r\n        var cardRank = cards[i].num;\r\n        isAce = cardRank == CARD_ACE;\r\n        // 判断牌里面有没有A\r\n        if (isAce && !isAceExist) isAceExist = !isAceExist && isAce;\r\n\r\n        // 如果是A且算是软牌,则算11\r\n        cardRank = (isAce && !hard) ? 11 : cardRank;\r\n        // 点数超过10都算10点\r\n        sum += (cardRank > 10 && !isAce) ? 10 : cardRank;\r\n    }\r\n\r\n    // A当做软牌(11点)时爆牌,才需要重新计算。\r\n    if (sum > RANK_21 && isAceExist && !hard) {\r\n        return this.countCard(cards, true, canBlackJack);\r\n    }\r\n\r\n    var isBust = sum > RANK_21; // 是否爆牌\r\n\r\n    var isBlackJack = canBlackJack && cardNum == 2 &&\r\n        ((cards[0].num == 1 && cards[1].num >= 10) || (cards[0].num >= 10 && cards[1].num == 1));\r\n\r\n    var isFiveDragon = !isBust && cardNum >= 5;\r\n\r\n    return {\r\n        sum: sum,\r\n        isBust: isBust,\r\n        isBlackJack: isBlackJack,\r\n        isFiveDragon: isFiveDragon\r\n    };\r\n};\r\nmodule.exports = Util;"]}