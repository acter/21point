{"version":3,"sources":["../../../../assets/Script/components/player.js"],"names":["cc","Class","extends","Component","properties","onLoad","MAX_TIME","baseBet","betNum","data","betNumSpr","buyInsuranceFlagSpr","progressTimer","cardBoxes","betSprites","insuranceBets","isPlaying","leftTime","coinX","coinY","getCoinXY","playerBg","node","getChildByName","prossNode","loadInfo","userID","nickname","faceID","score","loadHead","loadName","loadScore","img","headImg","headImage","name","console","log","player_name","getComponent","Label","string","showTip","playertip","active","action1","scaleTo","action2","finished","callFunc","isShowTip","action3","sequence","repeat","runAction","i","push","initMembers","update","dt","precent","temp","Sprite","fillRange","onWagerHandler","bet_num","coin","betLabel","Number","gold","CoinXY","randx","Math","floor","random","length","randy","coin_x","slice","coin_y","parent","coinsp","sp","s","moveTo","p"],"mappings":"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","file":"player.js","sourcesContent":["\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n\r\n    },\r\n\r\n    onLoad: function() {\r\n        this.MAX_TIME = 10;\r\n        this.baseBet = 0;\r\n        this.betNum = 0;\r\n        this.data = null;\r\n        this.betNumSpr = null;\r\n        this.buyInsuranceFlagSpr = null;\r\n        this.progressTimer = null;\r\n        this.cardBoxes = {};\r\n        this.betSprites = [];\r\n        this.insuranceBets = [];\r\n        this.isPlaying = false;\r\n        this.leftTime = 10;\r\n        this.coinX = [];\r\n        this.coinY = [];\r\n        this.getCoinXY();\r\n        // this.showTip()\r\n        this.playerBg = this.node.getChildByName(\"21dian-playerBg\")\r\n        this.prossNode = this.playerBg.getChildByName('21dian-ui_pk_bjdt')\r\n    },\r\n    //加载用户数据\r\n    loadInfo(data){\r\n        this.data = data;\r\n        this.userID = data.userID;\r\n        var nickname = data.nickname;\r\n        var faceID = data.faceID;\r\n        var score = data.score;\r\n        this.loadHead(faceID);\r\n        this.loadName(nickname);\r\n        this.loadScore(score);\r\n    },\r\n    //加载头像\r\n    loadHead(img) {\r\n        this.playerBg = this.node.getChildByName('21dian-playerBg');\r\n        this.headImg =  this.playerBg.getChildByName('head-image');\r\n        this.headImage = this.headImg.getChildByName('headimg');\r\n\r\n    },\r\n    //加载昵称\r\n    loadName(name){\r\n        console.log('name',name)\r\n        this.player_name = this.playerBg.getChildByName('player-name');\r\n        this.player_name.getComponent(cc.Label).string = name;\r\n    },\r\n    //加载余额\r\n    loadScore(score){\r\n        this.score = this.playerBg.getChildByName('gold');\r\n        this.score.getComponent(cc.Label).string = score;\r\n    },\r\n    //提示位置\r\n    showTip(){\r\n\r\n        this.playertip = this.node.getChildByName(\"tip\");\r\n        this.playertip.active = true;\r\n        var action1 = cc.scaleTo(0.2, 1.2, 1.2);\r\n        var  action2= cc.scaleTo(0.2, 1, 1);\r\n\r\n        var finished = cc.callFunc(function () {\r\n           this.playertip.active = false; this.isShowTip = true;\r\n        }, this)\r\n        var action3 = cc.sequence(cc.sequence(action1, action2).repeat(5),finished)\r\n        // var callFunc = cc.callFunc(this.playertip.active,false)\r\n        this.playertip.runAction(action3);// right\r\n\r\n    },\r\n    //获取金币的x和y的坐标范围\r\n    getCoinXY(){\r\n        for(var i = -35;i<=35;i++){\r\n            this.coinX.push(i);\r\n            this.coinY.push(i);\r\n        }\r\n\r\n    },\r\n    //\r\n\r\n    // 初始化成员变量\r\n    initMembers: function(data){\r\n        this.data = data;\r\n        this.betNum = 0;\r\n        this.cardBoxes = {};\r\n        this.betSprites = [];\r\n        // this.leftTime = data.leftTime;\r\n    },\r\n\r\n    update:function(dt){\r\n\r\n        this.leftTime -=dt ;\r\n        let precent = this.leftTime /this.MAX_TIME;\r\n\r\n        let temp =this.prossNode.getComponent(cc.Sprite);\r\n        if(this.leftTime <= 0){\r\n            temp.fillRange =0;\r\n            return;\r\n        }\r\n\r\n        temp.fillRange = precent;\r\n    },\r\n    onWagerHandler: function(bet_num,coin){\r\n        if(this.betNum <20000000){//如果大于最大下注数,就停止下注\r\n            var betNum = bet_num;\r\n            this.score.getComponent(cc.Label).string -= bet_num;\r\n            this.betLabel = this.playerBg.getChildByName('bet_num');\r\n            this.betLabel.active  = true;\r\n            this.betLabel.getComponent(cc.Label).string = Number(this.betLabel.getComponent(cc.Label).string) + Number(bet_num);\r\n            //记录下注数\r\n            this.betNum = Number(this.betLabel.getComponent(cc.Label).string);\r\n            this.gold = this.node.getChildByName('gold');\r\n\r\n            var CoinXY = this.coinX;\r\n            // 获取随机数\r\n            var randx = Math.floor( Math.random() * CoinXY.length );\r\n            var randy = Math.floor( Math.random() * CoinXY.length );\r\n            // 随机从数组中取出某值\r\n\r\n            var coin_x = CoinXY.slice(randx, randx+1)[0];\r\n            var coin_y = CoinXY.slice(randy, randy+1)[0];\r\n\r\n\r\n            coin.parent = this.gold;\r\nvar coinsp = coin.getComponent(cc.Sprite).sp\r\n            coinsp.s\r\n            coin.runAction(cc.moveTo(0.3,cc.p(coin_x,coin_y)))\r\n            return;\r\n        }else{\r\n            return;\r\n        }\r\n\r\n\r\n        // var betNum = data.betNum;\r\n        // var score = data.score;\r\n        // arr = arr || this._betSprites;\r\n        //\r\n        // var iteration = function(betNum, arr){\r\n        //     var left = 0;\r\n        //     var intNum = 0;\r\n        //     var base = 1;\r\n        //     var bets = [10, 100, 1000, 10000, 100000, 1000000];\r\n        //\r\n        //     for (var i = bets.length - 1; i >= 0; i--) {\r\n        //         base = bets[i];\r\n        //         if (betNum >= base) {\r\n        //             intNum = Math.floor(betNum / base);\r\n        //             left = betNum - intNum * base;\r\n        //             break;\r\n        //         }\r\n        //     }\r\n        //\r\n        //     for (var j = 0; j < intNum; j++) {\r\n        //         var img = \"#21dian/coin_\" + base + \".png\";\r\n        //         var betSpr = new cc.Sprite(img).to(this).p(65, 86).qscale(0.5);\r\n        //\r\n        //         (function(betSpr, j){\r\n        //             var center = cc.p(65, 280);\r\n        //             var rad = Math.random() * 2 * Math.PI;\r\n        //             var x = center.x + 50 * Math.cos(rad) * Math.random();\r\n        //             var y = center.y + 50 * Math.sin(rad) * Math.random();\r\n        //             betSpr.runAction(new cc.Sequence(\r\n        //                 new cc.DelayTime(0.2 * j),\r\n        //                 new cc.CallFunc(function(){\r\n        //                     SoundEngine.playEffect(\"res/21dian/sound/Bet.mp3\");\r\n        //                 }.bind(this)),\r\n        //                 new cc.MoveTo(0.2, cc.p(x, y))\r\n        //             ));\r\n        //         })(betSpr, j);\r\n        //\r\n        //         arr.push(betSpr);\r\n        //     }\r\n        //\r\n        //     if (left > 10) return iteration(left, arr);\r\n        // }.bind(this);\r\n        //\r\n        // // 开始迭代下金币\r\n        // betNum && iteration(betNum - this._betNum, arr);\r\n        // // 更新筹码\r\n        // betNum && this.loadBet(betNum);\r\n        // // 更新分数\r\n        // this._scoreLab.setString(\"\" + score);\r\n    },\r\n});"]}