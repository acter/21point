{"version":3,"sources":["../../../../assets/Script/net/Connector.js"],"names":["_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","Constructor","protoProps","staticProps","prototype","_classCallCheck","instance","TypeError","SocketIO","window","io","Connector","sock","isConnecting","isConnect","activeDisConnect","value","connect","uri","serverURI","cc","log","reconnection","on","onConnect","bind","onDisconnct","onError","onMsg","data","onfire","fire","eventName","disconnect","close","emit","route","console","error","module","exports"],"mappings":"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","file":"Connector.js","sourcesContent":["\"use strict\";\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar SocketIO = SocketIO || window.io;\n\nvar Connector = function () {\n    function Connector() {\n        _classCallCheck(this, Connector);\n\n        this.sock = null;\n        this.isConnecting = false;\n        this.isConnect = false;\n        this.activeDisConnect = false;\n    }\n\n    _createClass(Connector, [{\n        key: \"connect\",\n        value: function connect(uri) {\n            this.serverURI = uri;\n            this.sock = null;\n            this.isConnecting = true;\n\n            cc.log(\"正在连接中...\", uri);\n            this.sock = SocketIO.connect(uri, {\n                reconnection: false\n            });\n            //链接事件\n            this.sock.on(\"connect\", this.onConnect.bind(this));\n            this.sock.on(\"disconnect\", this.onDisconnct.bind(this));\n            this.sock.on(\"error\", this.onError.bind(this));\n            this.sock.on(\"msg\", this.onMsg.bind(this));\n        }\n    }, {\n        key: \"onConnect\",\n        value: function onConnect(data) {\n            cc.log(\"连接成功: \" + this.serverURI);\n            this.isConnect = true;\n            this.isConnecting = false;\n            onfire.fire(\"onConnect\", data);\n        }\n    }, {\n        key: \"onDisconnct\",\n        value: function onDisconnct(data) {\n            cc.log(\"断开连接----\");\n            this.isConnect = false;\n            this.isConnecting = false;\n            this.sock = null;\n            onfire.fire(\"onDisconnct\", data);\n        }\n    }, {\n        key: \"onError\",\n        value: function onError(data) {\n            cc.log(\"onError----\");\n            this.isConnecting = false;\n            this.isConnect = false;\n            this.sock = null;\n            onfire.fire(\"onError\", data);\n        }\n    }, {\n        key: \"onMsg\",\n        value: function onMsg(eventName, data) {\n            cc.log(\"onMsg----\", eventName, data);\n            onfire.fire(eventName, data);\n        }\n    }, {\n        key: \"disconnect\",\n        value: function disconnect() {\n            this.sock && this.sock.close();\n        }\n\n        /**\r\n         * 发送数据包\r\n         * @param data\r\n         */\n\n    }, {\n        key: \"emit\",\n        value: function emit(route, eventName, data) {\n            route = route || \"plaza\";\n            eventName = eventName || \"message\";\n            if (this.sock == null) return;\n\n            console.error(eventName, data);\n            this.sock.emit(route, eventName, data);\n        }\n    }]);\n\n    return Connector;\n}();\n\nmodule.exports = Connector;\n//# sourceMappingURL=Connector.js.map"]}