{"version":3,"sources":["../../../Script/components/player.js"],"names":["playerTypes","require","playerType","cc","Class","extends","Component","properties","onLoad","isReadyEnd","MAX_TIME","baseBet","betNum","buyInsuranceFlagSpr","progressTimer","data","betNumSpr","cardBoxes","betSprites","insuranceBets","isPlaying","leftTime","coinX","coinY","getCoinXY","initNodes","loadProgressTimer","loadInfo","allSprites","spriteFrames","type","TYPE_DEALER","loadFace","loadPlayInfo","onWagerHandler","playerBgNode","node","getChildByName","headImgNode","headImageNode","bet_numNode","player_nameNode","goldNode","tipNode","playerBg","headImg","headImage","getComponent","Label","string","nickname","score","Sprite","spriteFrame","getSpriteFrame","_scoreLab","showTip","active","action1","scaleTo","action2","finished","callFunc","isShowTip","action3","sequence","repeat","runAction","i","push","progress","proTimer","_jindutiaotime","time","self","scheduleOnce","fillRange","onfire","fire","hideProgressTimer","bind","showProgressTimer","percent","initMembers","onPlayerInHandler","myUserItem","GD","clientKernel","userID","chairID","point","PLAYER_POINTS","playerSpr","PlayerSprite","to","p","players","playerBet","bet_num","coin","arr","Number","betLabel","gold","CoinXY","randx","Math","floor","random","length","randy","coin_x","slice","coin_y","parent","seq","moveTo","arrItem","left","intNum","base","bets","reset","key","_cardBoxes","cardBox","deleteSelf","j","_betSprites","betSpr","splice","removeFromParent","removeBetNumSpr","_betNum","_isPlaying","isDealer","getUserID","getCurScore","parseInt"],"mappings":"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","file":"player.js","sourcesContent":["var playerTypes = require('define').playerType;\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n\r\n    },\r\n\r\n    onLoad: function() {\r\n        this.isReadyEnd = false;\r\n        this.MAX_TIME = 10;\r\n        this.baseBet = 0;\r\n        this.betNum = 0;\r\n        this.buyInsuranceFlagSpr = null;\r\n        this.progressTimer = null;\r\n        this.data = null;\r\n        this.betNumSpr = null;\r\n        this.cardBoxes = {};\r\n        this.betSprites = [];\r\n        this.insuranceBets = [];\r\n        this.isPlaying = false;\r\n        this.leftTime = 10;\r\n        this.coinX = [];\r\n        this.coinY = [];\r\n        this.getCoinXY();\r\n        this.initNodes();\r\n        this.loadProgressTimer()\r\n\r\n    },\r\n    //加载用户数据\r\n    loadInfo(data,allSprites){\r\n        this.data = data;\r\n        this.spriteFrames = allSprites;\r\n        if (data.type != playerTypes.TYPE_DEALER) {\r\n            // 加载头像\r\n            this.loadFace();\r\n            // 加载玩家信息\r\n            this.loadPlayInfo()\r\n            // 加载购买了保险的提示\r\n            // this.loadBuyInsuranceFlagSprite();\r\n            // 加载时间进度条\r\n            this.loadProgressTimer();\r\n            // 加载筹码\r\n            this.onWagerHandler(data);\r\n        } else {\r\n            // this.setOpacity(0);\r\n        }\r\n\r\n        // this.userID = data.userID;\r\n        // var nickname = data.nickname;\r\n        // var faceID = data.faceID;\r\n        // var score = data.score;\r\n        //\r\n        // this.loadName(nickname);\r\n        // this.loadScore(score);\r\n    },\r\n    //加载节点\r\n    initNodes(){\r\n        this.playerBgNode =  this.node.getChildByName('21dian-playerBg');\r\n        this.headImgNode =  this.playerBgNode.getChildByName('head-image');\r\n        this.headImageNode = this.headImgNode.getChildByName('headimg');\r\n        this.bet_numNode = this.playerBgNode.getChildByName('bet_num');\r\n        this.player_nameNode = this.playerBgNode.getChildByName('player-name');\r\n        this.goldNode =  this.playerBgNode.getChildByName('gold');\r\n        this.tipNode = this.node.getChildByName('tip');\r\n\r\n\r\n    },\r\n    // 加载头像\r\n    loadFace() {\r\n        this.playerBg = this.node.getChildByName('21dian-playerBg');\r\n        this.headImg =  this.playerBg.getChildByName('head-image');\r\n        this.headImage = this.headImg.getChildByName('headimg');\r\n         // this.headImage.getComponent(cc.Sprite).spriteFrame = this.spriteFrames.getSpriteFrame('21dian-playerBg')\r\n\r\n    },\r\n    //加载玩家信息\r\n    loadPlayInfo(){\r\n        this.player_nameNode.getComponent(cc.Label).string = this.data.nickname;\r\n        this.goldNode.getComponent(cc.Label).string = this.data.score;\r\n        this.playerBg.getComponent(cc.Sprite).spriteFrame = this.spriteFrames.getSpriteFrame('21dian-playerBg');\r\n        // var self = this;\r\n        // cc.loader.loadRes(\"game\", cc.SpriteAtlas, function (err, atlas) {\r\n        //     self.playerBg.getComponent(cc.Sprite).spriteFrame = atlas.getSpriteFrame('21dian-playerBg');\r\n        // });\r\n        this._scoreLab = this.data.score;\r\n    },\r\n\r\n    //提示位置\r\n    showTip(){\r\n        this.tipNode.active = true;\r\n        var action1 = cc.scaleTo(0.2, 1.2, 1.2);\r\n        var  action2= cc.scaleTo(0.2, 1, 1);\r\n\r\n        var finished = cc.callFunc(function () {\r\n            this.tipNode.active = false; this.isShowTip = true;\r\n        }, this)\r\n        var action3 = cc.sequence(cc.sequence(action1, action2).repeat(5),finished)\r\n        // var callFunc = cc.callFunc(this.playertip.active,false)\r\n        this.tipNode.runAction(action3);// right\r\n\r\n    },\r\n    //获取金币的x和y的坐标范围\r\n    getCoinXY(){\r\n        for(var i = -35;i<=35;i++){\r\n            this.coinX.push(i);\r\n            this.coinY.push(i);\r\n        }\r\n\r\n    },\r\n    // 加载时间进度条\r\n    loadProgressTimer(){\r\n        this.progress = this.playerBgNode.getChildByName('21dian-ui_pk_bjdt');\r\n        this.progress.active = false;\r\n        var proTimer = this.progress.getComponent(cc.Sprite)\r\n        this.progressTimer = proTimer;\r\n    },\r\n    _jindutiaotime:function(time){\r\n        var self = this\r\n        if(time > 0){\r\n            this.scheduleOnce(function() {\r\n                // cc.log(time)\r\n                this.progressTimer.fillRange = time / (this.MAX_TIME * 1000);\r\n                time =  time - 10;\r\n                self._jindutiaotime(time)\r\n            }, 0.01);\r\n        }\r\n        else {\r\n            this.progress.active = false\r\n            onfire.fire('readyEnd',this.hideProgressTimer.bind(this));\r\n\r\n        }\r\n    },\r\n// 显示进度条\r\n    showProgressTimer(time){\r\n        time = time || this.MAX_TIME;\r\n        var percent = time / this.MAX_TIME * 100;\r\n        if (this.progressTimer) {\r\n            this.progress.active = true;\r\n        } else {\r\n            this.loadProgressTimer();\r\n        }\r\n        this.progressTimer.fillRange = percent;\r\n        this._jindutiaotime(time)\r\n    },\r\n    // 隐藏进度条\r\n    hideProgressTimer(){\r\n        this.progressTimer && (this.progress.active = false);\r\n    },\r\n\r\n    // 初始化成员变量\r\n    initMembers(data){\r\n        this.data = data;\r\n        this.betNum = 0;\r\n        this.cardBoxes = {};\r\n        this.betSprites = [];\r\n        // this.leftTime = data.leftTime;\r\n    },\r\n\r\n    // 其他玩家进场的处理函数\r\n    onPlayerInHandler(data){\r\n        var myUserItem = GD.clientKernel.myUserItem;\r\n        if (myUserItem.userID == data.userID) return;\r\n\r\n        var chairID = data.chairID;\r\n        var point = this.PLAYER_POINTS[chairID];\r\n        var playerSpr = new PlayerSprite(data).to(this).p(point);\r\n\r\n        this.players[chairID] = playerSpr;\r\n    },\r\n    //玩家下注\r\n    playerBet(bet_num,coin,spriteFrame){\r\n\r\n        var arr = []\r\n        //如果大于最大下注数,就停止下注\r\n        var betNum = bet_num;\r\n\r\n        this.score.getComponent(cc.Label).string = Number(this.score.getComponent(cc.Label).string)-Number(bet_num);\r\n        this.betLabel = this.playerBg.getChildByName('bet_num');\r\n        this.betLabel.active  = true;\r\n        this.betLabel.getComponent(cc.Label).string = Number(this.betLabel.getComponent(cc.Label).string) + Number(bet_num);\r\n\r\n        //记录下注数\r\n        this.betNum = Number(this.betLabel.getComponent(cc.Label).string);\r\n        this.gold = this.node.getChildByName('gold');\r\n\r\n        var CoinXY = this.coinX;\r\n        // 获取随机数\r\n        var randx = Math.floor( Math.random() * CoinXY.length );\r\n        var randy = Math.floor( Math.random() * CoinXY.length );\r\n        // 随机从数组中取出某值\r\n        var coin_x = CoinXY.slice(randx, randx+1)[0];\r\n        var coin_y = CoinXY.slice(randy, randy+1)[0];\r\n        coin.parent = this.gold;\r\n        coin.getComponent(cc.Sprite).spriteFrame = spriteFrame;\r\n        var seq = cc.moveTo(0.3,cc.p(coin_x,coin_y))\r\n        //金币移动\r\n        coin.runAction(seq)\r\n        return;\r\n\r\n    },\r\n    //下注的金币处理函数\r\n    onWagerHandler:function(betNum,arr){\r\n        if(betNum == 0) return;\r\n        var arrItem = [];\r\n        var left = 0;\r\n        var intNum = 0;\r\n        var base;\r\n        var bets = [10, 100, 1000, 10000, 100000, 1000000];\r\n\r\n        for(var i = 0;i<bets.length;i++){\r\n\r\n            if(betNum == bets[i]){\r\n                base = bets[i];\r\n                intNum = Math.floor(betNum/base);\r\n                arrItem.push(base)\r\n                arrItem.push(intNum)\r\n                left = 0;\r\n                break;\r\n            }\r\n            if(betNum>bets[i]&&betNum<bets[i+1]){\r\n                base = bets[i]\r\n                intNum = Math.floor(betNum/base)\r\n                left = betNum-intNum*base;\r\n                arrItem.push(base)\r\n                arrItem.push(intNum)\r\n                break;\r\n            }\r\n        }\r\n        if(arrItem.length>0) arr.push(arrItem);\r\n\r\n        if(left>10) this.onWagerHandler(left,arr)\r\n        return arr;//例:500下注 返回[[100,5]] 1300  [[1000,1],[100,3]]\r\n    },\r\n    reset(){\r\n        for (var key in this._cardBoxes) {\r\n            var cardBox = this._cardBoxes[key];\r\n            cardBox.deleteSelf();\r\n            delete this._cardBoxes[key];\r\n        }\r\n\r\n        for (var j = this._betSprites.length - 1; j >= 0; j--) {\r\n            var betSpr = this._betSprites.splice(j, 1)[0];\r\n            betSpr.removeFromParent();\r\n        }\r\n        // 移除下注的筹码精灵\r\n        this.removeBetNumSpr();\r\n        this._betNum = 0;\r\n        this._isPlaying = false;\r\n        this._betSprites = [];\r\n        this._cardBoxes = {};\r\n    },\r\n    // 是否是庄家\r\n    isDealer(){\r\n        return this.data.isDealer;\r\n    },\r\n    // 获取用户ID\r\n    getUserID(){\r\n        return this.data.userID;\r\n    },\r\n    getCurScore: function(){\r\n        return parseInt(this._scoreLab);\r\n    },\r\n});"]}